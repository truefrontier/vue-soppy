# vue-soppy

[![npm version](https://badge.fury.io/js/vue-soppy.svg)](https://badge.fury.io/js/vue-soppy)

## What and Why?
Check out [this article on Medium](https://medium.com/@kevinkirchner/a-ready-to-try-concept-in-response-to-second-guessing-the-modern-web-6946ec4d0598) to get a better understanding why vue-soppy exists.

## How to setup

__NOTE:__ This setup assumes you're using a [vue-cli](https://cli.vuejs.org/) project with [vue-router](https://router.vuejs.org/) and [vuex](https://vuex.vuejs.org/).

```
$ vue create my-project && cd my-project/
$ npm install vue-soppy
```

---

__src/main.js__
```
import SoppyLoadbar from 'vue-soppy/components/SoppyLoadbar';
import SoppyLink from 'vue-soppy/components/SoppyLink';
Vue.component('soppy-loadbar', SoppyLoadbar);
Vue.component('soppy-link', SoppyLink);
```

- Use `<soppy-link>` to take advantage of extra functionality like preloading data on link hover. Use it like `<router-link>` and check out [the component file](https://github.com/truefrontier/vue-soppy/blob/master/components/SoppyLink.vue) for more details.
- `<soppy-loadbar>` is a tailwindcss-styled component showing the load progress of the soppy page requests.

---

__public/index.html__ (optional)
```
<script>
  window.SoppyState = <% if (NODE_ENV === 'production') { %>@json(array_merge($data, []))<% } else { %>{}<% } %>;
</script>
```

You can replace `@json(array_merge($data, []))` with whatever your framework can inject data with if you're not using [laravel-soppy](https://github.com/truefrontier/laravel-soppy)

---

__src/store/index.js__
```
import Vue from 'vue';
import Vuex from 'vuex';
import soppy from 'vue-soppy/store/modules/soppy';
import { soppyState, soppyActions, soppyMutations  } from 'vue-soppy/utils/storing';
import routesJSON from '@/router/routes.json';


Vue.use(Vuex);

const initialState = {
  // Add any defaults for properties you plan on passing into your app
};

export default new Vuex.Store({
  state: Object.assign(soppyState(routesJSON), initialState, window.SoppyState || {}),

  actions: Object.assign(soppyActions, {
    // Your custom actions
  }),

  mutations: Object.assign(soppyMutations, {
    // Your custom mutations
  }),

  modules: {
    soppy,
  },
});
```

---

__src/router/routes.json__ - Ideally, this file is auto-generated by some external script or command (check out [laravel-soppy](https://github.com/truefrontier/laravel-soppy) for the Laravel setup for vue-soppy)
```
[
  {
    name: 'app.welcome',
    path: '/',
  }
]
```

__NOTE:__ The `component` piece to your routes is dynamically generated from the `name` in [/utils/routing.js](https://github.com/truefrontier/vue-soppy/blob/master/utils/routing.js#L5). For example: the component for `app.welcome` will be `() => import('@/views/Welcome.vue')`; or for nested routes like `app.user.settings` will used the component `() => import('@/views/user/Settings.vue')`. 

---

__src/router/index.js__
```
import Vue from 'vue';
import VueRouter from 'vue-router';
import { soppyRoutes, soppyRouter } from 'vue-soppy/utils/routing';
import routesJSON from '@/router/routes.json';
// import SoppyBus from 'vue-soppy/utils/bus';

const routes = [
  // Override (or add more) routes found in routesJSON
]

const router = new VueRouter({
  mode: 'history',
  base: process.env.BASE_URL,
  routes: soppyRoutes(routesJSON, routes),
});

// For when any requests return a 401 Unauthorized status
// SoppyBus.$on('unauthorized', () => {
//   router.replace({ name: 'app.login' });
// });

export default soppyRouter(router);
```


